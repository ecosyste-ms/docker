<% @meta_title = "#{@version} | #{@package.name}" %>
<div class="container-sm">
  <h1>
    <%= link_to @package.name, @package %> : <%= @version %>
  </h1>

  <p><%= @package.description %></p>

  <p>
    <small class='text-muted'>
      <% if @package.latest_release_published_at %>
        <span title="<%= @package.latest_release_published_at %>">Latest release: <%= time_ago_in_words @package.latest_release_published_at %> ago</span>
      <% end %>
      
      <% if @package.downloads %>
        - <%= number_with_delimiter @package.downloads %> downloads
      <% end %>

      <% if @package.dependencies_count %>
        - <%= number_with_delimiter @package.dependencies_count %> dependencies
      <% end %>
    </small>
  </p>

  <% if @version.dependencies.any? %>
    <h2>Dependencies</h2>
    
    <div class="card my-3">
      <% @version.dependencies.group_by{|d| d.ecosystem}.each do |ecosystem, dependencies| %>

        <div class="card-header">
          <%= ecosystem %>
        </div>
        <ul class="list-group list-group-flush">
          <% dependencies.each do |dependency| %>
            <% next if dependency.package_name.starts_with?('.')%>
            <li class="list-group-item">
              <%= link_to dependency.package_name, dependency_path(dependency.ecosystem, dependency.package_name) %>

              <small class='text-muted'>
                <i><%= dependency.requirements %></i>
              </small>
            </li>
          <% end %>
        </ul>
      <% end %>
    </div>
  <% end %>
</div>